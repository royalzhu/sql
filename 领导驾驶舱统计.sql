select t.zdmc,t.times,t.qybh ,e.qymc,t.hxxylnd,t.adnd from T_EPW_SSSJ t,ep_yyyd_enterpriseinfo e where t.qybh = e.id and e.SFWSCLC ='1' and t.hxxylnd >0 
select      r.monitoringpointname,      sum(decode(r.factorname,'高锰酸盐指数',r.pollutantvalue,0)) gmsyzs,      sum(decode(r.factorname,'总氮',r.pollutantvalue,0)) n_total,      sum(decode(r.factorname,'总磷',r.pollutantvalue,0)) p_total,    r.tstamp     from (     SELECT m.monitoringpointname, m.factorname, round(m.pollutantvalue,2) pollutantvalue,to_char(m.tstamp,'yyyy-MM-dd HH24:mi:ss') tstamp    from (     select ROW_NUMBER() OVER(PARTITION BY v.monitoringpointname, v.factorname ORDER BY v.tstamp DESC) rn,     v.monitoringpointname, v.factorname, v.pollutantvalue, v.tstamp     from (select t2.monitoringpointname,     t3.factorname,     t1.pollutantvalue,     t1.tstamp       from t_lpw_hourreport  t1,     T_LX_MonitoringPoint  t2,      basedat.T_AXW_BI_Factors t3      where t1.pointid = t2.pointid     and t1.pollutantvalue is not null    and t1.pollutantcode = t3.factorcode     and t2.sitetypeuid = 'c2bd6e53-cdee-4af2-badd-5d32cee2b753'       and t3.factorname in ('高锰酸盐指数', '总磷', '总氮')     ) v        ) m      WHERE m.rn = 1 ) r      group by r.monitoringpointname, r.tstamp 
select substr(d.allday,9,2)  datatime, w.aqi   from (SELECT to_char((TO_DATE('2016-05-01', 'yyyy-mm-dd') + LEVEL - 1),         'yyyy-mm-dd') allday  FROM DUAL  CONNECT BY LEVEL < add_months(to_date('2016-05-01', 'yyyy-mm-dd'), 1) -         TO_DATE('2016-05-01', 'yyyy-mm-dd') + 1) d,  (select ceil(avg(v.aqi)) aqi, v.datatime  from (select t.aqi, to_char(t.timepoint, 'yyyy-mm-dd') datatime     from analys.T_LS_CHINA_RT_CITY_AVERAGE t   where t.area in ('无锡市')     and t.timepoint >= TO_DATE('2016-05-01', 'yyyy-mm-dd')     and t.timepoint <         add_months(TO_DATE('2016-05-01', 'yyyy-mm-dd'), 1)) v   group by v.datatime) w  where d.allday = w.datatime(+)  order by d.allday
select w.name thqy,w.vaule,t.codmn,t.n_total,t.nh4_n,t.p_total,codcr,t.fyyzs,w.dataTime from (select '2016-06' dataTime,s.name,s.vaule from t_lpw_sequence s) w,  (  (  select thqy,dataTime,codmn,n_total,nh4_n,p_total,codcr,  round(10 * (0.109 + 2.661 * LN(decode(per_codmn,0,1,per_codmn))) * (0.6889 / 3.7558) +  10 * (9.436 + 1.624 * LN(decode(per_p_total,0,1,per_p_total))) * (0.7056 / 3.7558) +  10 * (5.453 + 1.694 * LN(decode(per_n_total,0,1,per_n_total))) * (0.6724 / 3.7558) +  10 * (2.5 + 1.086 * LN(decode(per_yls * 1000,0,1,per_yls * 1000))) * (1 / 3.7558) +  10 * (5.118 - 1.94 * LN(decode(per_tmd / 100,0,1,per_tmd / 100))) * (0.6889 / 3.7558),  1) as fyyzs from  (select t2.thqy,  round(avg(t1.codmn), 1) as per_codmn,  round(avg(t1.n_total), 2) as  per_n_total,  round(avg(t1.nh4_n), 2) as  per_nh4_n,  round(avg(t1.p_total), 3) as  per_p_total,  round(avg(t1.codcr), 0) as  per_codcr,  round(avg(t1.yls), 4) as  per_yls,  round(avg(t1.tmd), 0) as  per_tmd,  round(avg(t1.codmn), 1) as codmn,  round(avg(t1.n_total), 2) as n_total,  round(avg(t1.nh4_n), 2) as nh4_n,  round(avg(t1.p_total), 3) as p_total,  round(avg(t1.codcr), 0) as codcr,  round(avg(t1.yls), 4) as yls,  round(avg(t1.tmd), 0) as tmd,  to_char(t1.datatime, 'YYYY-MM') dataTime  from T_LPW_ORIGINALDATA t1, T_LPW_STATION t2  where t1.pointid = t2.pointid  and t2.thqy is not null  and to_char(t1.datatime, 'YYYY-MM')='2016-06'  group by t2.thqy,to_char(t1.datatime, 'YYYY-MM')  )  )  union all  (  select thqy,dataTime,codmn,n_total,nh4_n,p_total,codcr,  round(10 * (0.109 + 2.661 * LN(decode(per_codmn,0,1,per_codmn))) * (0.6889 / 3.7558) +  10 * (9.436 + 1.624 * LN(decode(per_p_total,0,1,per_p_total))) * (0.7056 / 3.7558) +  10 * (5.453 + 1.694 * LN(decode(per_n_total,0,1,per_n_total))) * (0.6724 / 3.7558) +  10 * (2.5 + 1.086 * LN(decode(per_yls * 1000,0,1,per_yls * 1000))) * (1 / 3.7558) +  10 * (5.118 - 1.94 * LN(decode(per_tmd / 100,0,1,per_tmd / 100))) * (0.6889 / 3.7558),         1) as fyyzs from    (select '太湖无锡水域' thqy,  round(avg(t1.codmn), 1) as per_codmn,  round(avg(t1.n_total), 2) as  per_n_total,  round(avg(t1.nh4_n), 2) as  per_nh4_n,  round(avg(t1.p_total), 3) as  per_p_total,  round(avg(t1.codcr), 0) as  per_codcr,  round(avg(t1.yls), 4) as  per_yls,  round(avg(t1.tmd), 0) as  per_tmd,  round(avg(t1.codmn), 1) as codmn,  round(avg(t1.n_total), 2) as n_total,  round(avg(t1.nh4_n), 2) as nh4_n,  round(avg(t1.p_total), 3) as p_total,  round(avg(t1.codcr), 0) as codcr,  round(avg(t1.yls), 4) as yls,  round(avg(t1.tmd), 0) as tmd,           to_char(t1.datatime, 'YYYY-MM') dataTime      from T_LPW_ORIGINALDATA t1, T_LPW_STATION t2     where t1.pointid = t2.pointid            and t2.sscs = '无锡'            and t2.thqy is not null           and to_char(t1.datatime, 'YYYY-MM')='2016-06'           group by to_char(t1.datatime, 'YYYY-MM')    )  )  union all  (       select thqy,dataTime, codmn,n_total,nh4_n,p_total,codcr,  round(10 * (0.109 + 2.661 * LN(decode(per_codmn,0,1,per_codmn))) * (0.6889 / 3.7558) +  10 * (9.436 + 1.624 * LN(decode(per_p_total,0,1,per_p_total))) * (0.7056 / 3.7558) +  10 * (5.453 + 1.694 * LN(decode(per_n_total,0,1,per_n_total))) * (0.6724 / 3.7558) +  10 * (2.5 + 1.086 * LN(decode(per_yls * 1000,0,1,per_yls * 1000))) * (1 / 3.7558) +  10 * (5.118 - 1.94 * LN(decode(per_tmd / 100,0,1,per_tmd / 100))) * (0.6889 / 3.7558),         1) as fyyzs from    (select '太湖非无锡水域' thqy,  round(avg(t1.codmn), 1) as per_codmn,  round(avg(t1.n_total), 2) as  per_n_total,  round(avg(t1.nh4_n), 2) as  per_nh4_n,  round(avg(t1.p_total), 3) as  per_p_total,  round(avg(t1.codcr), 0) as  per_codcr,  round(avg(t1.yls), 4) as  per_yls,  round(avg(t1.tmd), 0) as  per_tmd,  round(avg(t1.codmn), 1) as codmn,  round(avg(t1.n_total), 2) as n_total,  round(avg(t1.nh4_n), 2) as nh4_n,  round(avg(t1.p_total), 3) as p_total,  round(avg(t1.codcr), 0) as codcr,  round(avg(t1.yls), 4) as yls,  round(avg(t1.tmd), 0) as tmd,           to_char(t1.datatime, 'YYYY-MM') dataTime      from T_LPW_ORIGINALDATA t1, T_LPW_STATION t2     where t1.pointid = t2.pointid            and t2.sscs != '无锡'            and to_char(t1.datatime, 'YYYY-MM')='2016-06'            and t2.thqy is not null           group by to_char(t1.datatime, 'YYYY-MM')    )  )  union all  (       select thqy,dataTime,codmn,n_total,nh4_n,p_total,codcr,  round(10 * (0.109 + 2.661 * LN(decode(per_codmn,0,1,per_codmn))) * (0.6889 / 3.7558) +  10 * (9.436 + 1.624 * LN(decode(per_p_total,0,1,per_p_total))) * (0.7056 / 3.7558) +  10 * (5.453 + 1.694 * LN(decode(per_n_total,0,1,per_n_total))) * (0.6724 / 3.7558) +  10 * (2.5 + 1.086 * LN(decode(per_yls * 1000,0,1,per_yls * 1000))) * (1 / 3.7558) +  10 * (5.118 - 1.94 * LN(decode(per_tmd / 100,0,1,per_tmd / 100))) * (0.6889 / 3.7558),         1) as fyyzs from    (select '全太湖' thqy,  round(avg(t1.codmn), 1) as per_codmn,  round(avg(t1.n_total), 2) as  per_n_total,  round(avg(t1.nh4_n), 2) as  per_nh4_n,  round(avg(t1.p_total), 3) as  per_p_total,  round(avg(t1.codcr), 0) as  per_codcr,  round(avg(t1.yls), 4) as  per_yls,  round(avg(t1.tmd), 0) as  per_tmd,  round(avg(t1.codmn), 1) as codmn,  round(avg(t1.n_total), 2) as n_total,  round(avg(t1.nh4_n), 2) as nh4_n,  round(avg(t1.p_total), 3) as p_total,  round(avg(t1.codcr), 0) as codcr,  round(avg(t1.yls), 4) as yls,  round(avg(t1.tmd), 0) as tmd,           to_char(t1.datatime, 'YYYY-MM') dataTime      from T_LPW_ORIGINALDATA t1, T_LPW_STATION t2     where t1.pointid = t2.pointid            and t2.thqy is not null            and to_char(t1.datatime, 'YYYY-MM')='2016-06'          group by to_char(t1.datatime, 'YYYY-MM')    )    )  )t  where w.name = t.thqy(+)  and w.datatime = t.dataTime(+)  order by w.vaule 
select count(1) c from ep_yyyd_enterpriseinfo where sczt='0' 
select t.aqi, t.name, t.value  from (select t1.name, t.*  from analys.T_LS_CHINA_RT_CITY_AVERAGE t,  basedat.T_AD_YCYB_PARAMETER       t1  where t.area in ('无锡市')   and t1.parameterid = t.itemid   order by t.timepoint desc) t  where rownum <= 1
select count(1) c from ep_yyyd_enterpriseinfo where sczt='0' and sffsy='1' 
select systemzdli0_.ID as ID163_, systemzdli0_.ZDID as ZDID163_, systemzdli0_.MC as MC163_, systemzdli0_.VALUE as VALUE163_, systemzdli0_.SXH as SXH163_, systemzdli0_.ZDCODE as ZDCODE163_, systemzdli0_.MS as MS163_, systemzdli0_.PARENTID as PARENTID163_ from SYSTEM_ZDLIST systemzdli0_ where systemzdli0_.ZDCODE=? order by systemzdli0_.SXH
select count(1) c from ep_yyyd_enterpriseinfo where sczt='0' and sfzdy='1' 
select w.name thqy,w.vaule,t.codmn,t.n_total,t.nh4_n,t.p_total,codcr,t.fyyzs,w.dataTime from (select '2015-06' dataTime,s.name,s.vaule from t_lpw_sequence s) w,  (  (  select thqy,dataTime,codmn,n_total,nh4_n,p_total,codcr,  round(10 * (0.109 + 2.661 * LN(decode(per_codmn,0,1,per_codmn))) * (0.6889 / 3.7558) +  10 * (9.436 + 1.624 * LN(decode(per_p_total,0,1,per_p_total))) * (0.7056 / 3.7558) +  10 * (5.453 + 1.694 * LN(decode(per_n_total,0,1,per_n_total))) * (0.6724 / 3.7558) +  10 * (2.5 + 1.086 * LN(decode(per_yls * 1000,0,1,per_yls * 1000))) * (1 / 3.7558) +  10 * (5.118 - 1.94 * LN(decode(per_tmd / 100,0,1,per_tmd / 100))) * (0.6889 / 3.7558),  1) as fyyzs from  (select t2.thqy,  round(avg(t1.codmn), 1) as per_codmn,  round(avg(t1.n_total), 2) as  per_n_total,  round(avg(t1.nh4_n), 2) as  per_nh4_n,  round(avg(t1.p_total), 3) as  per_p_total,  round(avg(t1.codcr), 0) as  per_codcr,  round(avg(t1.yls), 4) as  per_yls,  round(avg(t1.tmd), 0) as  per_tmd,  round(avg(t1.codmn), 1) as codmn,  round(avg(t1.n_total), 2) as n_total,  round(avg(t1.nh4_n), 2) as nh4_n,  round(avg(t1.p_total), 3) as p_total,  round(avg(t1.codcr), 0) as codcr,  round(avg(t1.yls), 4) as yls,  round(avg(t1.tmd), 0) as tmd,  to_char(t1.datatime, 'YYYY-MM') dataTime  from T_LPW_ORIGINALDATA t1, T_LPW_STATION t2  where t1.pointid = t2.pointid  and t2.thqy is not null  and to_char(t1.datatime, 'YYYY-MM')='2015-06'  group by t2.thqy,to_char(t1.datatime, 'YYYY-MM')  )  )  union all  (  select thqy,dataTime,codmn,n_total,nh4_n,p_total,codcr,  round(10 * (0.109 + 2.661 * LN(decode(per_codmn,0,1,per_codmn))) * (0.6889 / 3.7558) +  10 * (9.436 + 1.624 * LN(decode(per_p_total,0,1,per_p_total))) * (0.7056 / 3.7558) +  10 * (5.453 + 1.694 * LN(decode(per_n_total,0,1,per_n_total))) * (0.6724 / 3.7558) +  10 * (2.5 + 1.086 * LN(decode(per_yls * 1000,0,1,per_yls * 1000))) * (1 / 3.7558) +  10 * (5.118 - 1.94 * LN(decode(per_tmd / 100,0,1,per_tmd / 100))) * (0.6889 / 3.7558),         1) as fyyzs from    (select '太湖无锡水域' thqy,  round(avg(t1.codmn), 1) as per_codmn,  round(avg(t1.n_total), 2) as  per_n_total,  round(avg(t1.nh4_n), 2) as  per_nh4_n,  round(avg(t1.p_total), 3) as  per_p_total,  round(avg(t1.codcr), 0) as  per_codcr,  round(avg(t1.yls), 4) as  per_yls,  round(avg(t1.tmd), 0) as  per_tmd,  round(avg(t1.codmn), 1) as codmn,  round(avg(t1.n_total), 2) as n_total,  round(avg(t1.nh4_n), 2) as nh4_n,  round(avg(t1.p_total), 3) as p_total,  round(avg(t1.codcr), 0) as codcr,  round(avg(t1.yls), 4) as yls,  round(avg(t1.tmd), 0) as tmd,           to_char(t1.datatime, 'YYYY-MM') dataTime      from T_LPW_ORIGINALDATA t1, T_LPW_STATION t2     where t1.pointid = t2.pointid            and t2.sscs = '无锡'            and t2.thqy is not null           and to_char(t1.datatime, 'YYYY-MM')='2015-06'           group by to_char(t1.datatime, 'YYYY-MM')    )  )  union all  (       select thqy,dataTime, codmn,n_total,nh4_n,p_total,codcr,  round(10 * (0.109 + 2.661 * LN(decode(per_codmn,0,1,per_codmn))) * (0.6889 / 3.7558) +  10 * (9.436 + 1.624 * LN(decode(per_p_total,0,1,per_p_total))) * (0.7056 / 3.7558) +  10 * (5.453 + 1.694 * LN(decode(per_n_total,0,1,per_n_total))) * (0.6724 / 3.7558) +  10 * (2.5 + 1.086 * LN(decode(per_yls * 1000,0,1,per_yls * 1000))) * (1 / 3.7558) +  10 * (5.118 - 1.94 * LN(decode(per_tmd / 100,0,1,per_tmd / 100))) * (0.6889 / 3.7558),         1) as fyyzs from    (select '太湖非无锡水域' thqy,  round(avg(t1.codmn), 1) as per_codmn,  round(avg(t1.n_total), 2) as  per_n_total,  round(avg(t1.nh4_n), 2) as  per_nh4_n,  round(avg(t1.p_total), 3) as  per_p_total,  round(avg(t1.codcr), 0) as  per_codcr,  round(avg(t1.yls), 4) as  per_yls,  round(avg(t1.tmd), 0) as  per_tmd,  round(avg(t1.codmn), 1) as codmn,  round(avg(t1.n_total), 2) as n_total,  round(avg(t1.nh4_n), 2) as nh4_n,  round(avg(t1.p_total), 3) as p_total,  round(avg(t1.codcr), 0) as codcr,  round(avg(t1.yls), 4) as yls,  round(avg(t1.tmd), 0) as tmd,           to_char(t1.datatime, 'YYYY-MM') dataTime      from T_LPW_ORIGINALDATA t1, T_LPW_STATION t2     where t1.pointid = t2.pointid            and t2.sscs != '无锡'            and to_char(t1.datatime, 'YYYY-MM')='2015-06'            and t2.thqy is not null           group by to_char(t1.datatime, 'YYYY-MM')    )  )  union all  (       select thqy,dataTime,codmn,n_total,nh4_n,p_total,codcr,  round(10 * (0.109 + 2.661 * LN(decode(per_codmn,0,1,per_codmn))) * (0.6889 / 3.7558) +  10 * (9.436 + 1.624 * LN(decode(per_p_total,0,1,per_p_total))) * (0.7056 / 3.7558) +  10 * (5.453 + 1.694 * LN(decode(per_n_total,0,1,per_n_total))) * (0.6724 / 3.7558) +  10 * (2.5 + 1.086 * LN(decode(per_yls * 1000,0,1,per_yls * 1000))) * (1 / 3.7558) +  10 * (5.118 - 1.94 * LN(decode(per_tmd / 100,0,1,per_tmd / 100))) * (0.6889 / 3.7558),         1) as fyyzs from    (select '全太湖' thqy,  round(avg(t1.codmn), 1) as per_codmn,  round(avg(t1.n_total), 2) as  per_n_total,  round(avg(t1.nh4_n), 2) as  per_nh4_n,  round(avg(t1.p_total), 3) as  per_p_total,  round(avg(t1.codcr), 0) as  per_codcr,  round(avg(t1.yls), 4) as  per_yls,  round(avg(t1.tmd), 0) as  per_tmd,  round(avg(t1.codmn), 1) as codmn,  round(avg(t1.n_total), 2) as n_total,  round(avg(t1.nh4_n), 2) as nh4_n,  round(avg(t1.p_total), 3) as p_total,  round(avg(t1.codcr), 0) as codcr,  round(avg(t1.yls), 4) as yls,  round(avg(t1.tmd), 0) as tmd,           to_char(t1.datatime, 'YYYY-MM') dataTime      from T_LPW_ORIGINALDATA t1, T_LPW_STATION t2     where t1.pointid = t2.pointid            and t2.thqy is not null            and to_char(t1.datatime, 'YYYY-MM')='2015-06'          group by to_char(t1.datatime, 'YYYY-MM')    )    )  )t  where w.name = t.thqy(+)  and w.datatime = t.dataTime(+)  order by w.vaule 
select count(1) c from ep_yyyd_enterpriseinfo where sczt='0' and sffxy='1' 
select t1.pointid,decode(t2.xzq,'宜兴市','宜兴市','市区') xzq,t2.pointname,t2.hlmc,t3.stjball,t3.lsl,to_char(t1.datatime,'YYYY-MM') datatime,t1.rjy,t1.codmn,t1.bod5,t1.nh4_n,t1.hff,t1.codcr,t1.p_total,t1.f,t1.cn_total,t1.s   from T_LPW_ORIGINALDATA t1, T_LPW_STATION t2,t_Lpw_Leveldata t3 where t1.pointid = t2.pointid and t1.id =t3.oid and t2.zycrh =1 and to_char(t1.datatime,'YYYY-MM') = '2016-06' order by t2.xzq,t2.pointid
select count(1) c from ep_yyyd_hjkeytable a ,ep_yyyd_enterpriseinfo b where a.epid=b.id  and b.sczt='0'and a.hjys Like '%1%' 
select m.hdszlb name,count(*) value  from (select w.xzqy,w.zzhdmc,w.hdszlb from   (  select row_number() over(partition by v.xh order by v.xh) as new_index , v.*  from   (select t.xh,t.xzqy,t.zzhdmc,t.hdszlb from t_lpw_hdzzdata t  where to_char(t.time,'yyyy-MM')= '2016-05') v  )  w  where w.new_index = 1) m  group by m.hdszlb 
select to_char(t3.stjball) name,count(*) value  from T_LPW_ORIGINALDATA t1,t_Lpw_Leveldata t3 where t1.pointid in (select distinct t2.pointid from T_LPW_STATION t2 where t2.sfhldm=1) and t1.id =t3.oid and to_char(t1.datatime,'yyyy-mm')='2016-05' group by t3.stjball
select aa.xzq, aa.ttnum, decode(bb.dbnum,null,0,bb.dbnum) dbnum,  decode(cc.pdbnum,null,0,cc.pdbnum) pdbnum  from (select t1.xzq, count(pointid) ttnum   from t_lpw_station      t1  where t1.sxdh=1  group by t1.xzq) aa,  (select ts.xzq, count(pointid) dbnum  from t_lpw_station ts   where ts.pointid in (select v.pointid     from (select t1.pointid, t2.stjball                          from t_lpw_station      t1,                               t_lpw_leveldata    t2,                               t_lpw_originaldata t3                         where t1.pointid = t3.pointid                           and t1.sxdh   = 1                           and t2.oid = t3.id                           and t2.datatime >=                                to_date('2016-01-01 00:00:00',                                       'yyyy-mm-dd hh24:mi:ss')                           and t2.datatime <                               to_date('2016-07-01 23:59:59',                                       'yyyy-mm-dd hh24:mi:ss')) v                 group by pointid, v.stjball                having max(v.stjball) < 4)  group by ts.xzq) bb,  (select ts.xzq, count(pointid) pdbnum  from t_lpw_station ts  where ts.pointid in (select v.pointid            from (select t1.pointid, t2.stjball   from t_lpw_station      t1,        t_lpw_leveldata    t2,                                  t_lpw_originaldata t3                         where t1.pointid = t3.pointid                           and t1.sxdh   = 1                           and t2.oid = t3.id                           and t2.datatime >=                               to_date('1970-01-01 00:00:00',                                       'yyyy-mm-dd hh24:mi:ss')                           and t2.datatime <                               to_date('1970-01-01 00:00:00',                                       'yyyy-mm-dd hh24:mi:ss')) v                 group by pointid, v.stjball               having max(v.stjball) < 4)  group by ts.xzq) cc  where aa.xzq = bb.xzq(+)   and aa.xzq = cc.xzq(+)   ORDER   BY   DECODE(aa.xzq,'江阴市','01','宜兴市','02','锡山区','03','惠山区','04','滨湖区','05','梁溪区','06','新吴区')
select count(1) c from ep_yyyd_hjkeytable a ,ep_yyyd_enterpriseinfo b where a.epid=b.id  and b.sczt='0'and a.hjys Like '%2%' 
select to_char(v.stjball) name,count(v.pointid) value from(  select distinct(t2.pointid) pointid, max(t2.stjball) stjball  from (select  t.pointid from T_LPW_STATION T where t.stwm = 1) t1,  t_lpw_leveldata t2  where t2.pointid = t1.pointid  and t2.datatime >=  to_date('2016-01-01 00:00:00', 'yyyy-mm-dd hh24:mi:ss')  and t2.datatime <  to_date('2016-07-01 23:59:59', 'yyyy-mm-dd hh24:mi:ss')  group by t2.pointid) v  group by v.stjball
select   tt.hlmc,  tt.pointname,  tt.jjxzq,  tt.szmb,  r.stjbqb,  r.codmn,  r.nh4_n,  r.p_total  from (select t1.pointid,  t1.hlmc,  t1.pointname,  t1.jjxzq,  t1.szmb,  t3.stjbqb,  t3.codmn,  t3.nh4_n,  t3.p_total  from T_LPW_STATION T1  left join t_lpw_originaldata t2  on t1.pointid = t2.pointid  left join t_lpw_leveldata t3  on t2.id = t3.oid  where t1.sfqybc = 1  and t2.datatime >=  to_date('2016-06-01 00:00:00', 'yyyy-mm-dd hh24:mi:ss')  and t2.datatime <  to_date('2016-07-01 00:00:00', 'yyyy-mm-dd hh24:mi:ss')  )  r ,T_LPW_STATION tt  where tt.pointid=r.pointid(+)  and  tt.sfqybc = 1  order by tt.pointid
select t.ssqx,count(1) total from   (select decode(e.ssqx ,'320202','320213','320203','320213','320205','320205','320211','320211','320282','320282',          '320204','320213' ,'320206','320206','320217','320217','320281','320281','320213','320213','320200'   ) ssqx from ep_yyyd_enterpriseinfo e where e.sczt='0' and e.ssqx in('320202','320203','320205','320211','320282','320204','320206','320217','320281','320213') ) t   group by t.ssqx   order by total desc
select n.dmnr name,decode(m.value,null,0,m.value) value  from  (select distinct(decode(t.dmnr,'新区','新吴','新吴','新吴','南长','梁溪','北塘','梁溪','崇安','梁溪','梁溪','梁溪',  '江阴','江阴','锡山','锡山','滨湖','滨湖','惠山','惠山','宜兴','宜兴','市本级'  )) dmnr from  basedat.t_ad_hjjc_comn_ggdmz t where t.DMJBH='11005' and (t.sfyx is null or t.sfyx=1)) n,  (select count(v.XFBH) value,qh.dmnr   from  (select decode(t.dmnr,'新区','新吴','新吴','新吴','南长','梁溪','北塘','梁溪','崇安','梁溪','梁溪','梁溪',  '江阴','江阴','锡山','锡山','滨湖','滨湖','惠山','惠山','宜兴','宜兴','市本级'  ) dmnr  ,t.dm from  basedat.t_ad_hjjc_comn_ggdmz t where t.DMJBH='11005' and (t.sfyx is null or t.sfyx=1)) qh,v_xfjbxx v  where qh.dm = v.BLBM  and v.sfzf is null    and v.GLCFJBBH is null    and v.TSSJ >=  to_date(to_char(sysdate,'yyyy')||'-01-01 00:00:00','yyyy-MM-dd  HH24:mi:ss')   and v.TSSJ <=  to_date(to_char(sysdate,'yyyy-MM-dd')||' 23:59:59','yyyy-MM-dd  HH24:mi:ss')   group by qh.dmnr) m   where  n.dmnr = m.dmnr(+)   order by decode(n.dmnr,'市本级',8,'江阴',1,'宜兴',2,'新吴',7,'梁溪',6,'锡山',3,'惠山',4,'滨湖',5) 
select qh.ssqx xzqh,decode(sum(sj.csl),null,0,round(sum(sj.csl)/10000,4)) csl   from ( select  '梁溪区' as ssqx from dual    union all  select  '锡山区' as ssqx from dual   union all select  '惠山区' as ssqx from dual   union all select  '滨湖区' as ssqx from dual   union all select  '新吴区' as ssqx from dual   union all select  '江阴市' as ssqx from dual   union all  select   '宜兴市' as ssqx from dual) qh,   (select t.qybm,t.wfdl,t.csl,   decode(t.xzqbm ,'320202','梁溪区','320203','梁溪区','320205','锡山区','320211','滨湖区','320282','宜兴市',   '320204','梁溪区' ,'320206','惠山区','320292','新吴区','320217','新吴区','320281','江阴市','320200','市本级','市本级') xzqh   from t_mx_sbwfxq t,ep_yyyd_enterpriseinfo e   where e.sczt = '0'   and t.qybm = e.id   and t.SCBJ='0'   and t.sbrq>=to_char(sysdate,'yyyy')||'01'   and t.sbrq<=to_char(sysdate,'yyyyMM')   and t.dw='吨') sj   where qh.ssqx = sj.xzqh(+)   group by qh.ssqx    order by decode(qh.ssqx ,'江阴市',1,'宜兴市',2,'新吴区',7,'梁溪区',6,'锡山区',3,'惠山区',4,'滨湖区',5)
